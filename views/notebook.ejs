<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>筆記本 - <%= siteSettings.site_title %></title>
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="/css/notebook.css" />
  <link rel="manifest" href="/manifest.json" />
</head>
<body>
  <div class="container">
    <header>
      <h1>筆記本</h1>
      <button id="new-note">新增筆記</button>
    </header>

    <div class="controls">
      <input type="text" id="search" placeholder="搜尋筆記..." />
      <select id="tag-filter">
        <option value="">所有標籤</option>
        <% (Array.isArray(tags) ? tags : []).forEach(t => { %>
          <option value="<%= t.id %>"><%= t.name %></option>
        <% }) %>
      </select>
      <select id="sort">
        <option value="updated">最近修改</option>
        <option value="title">標題排序</option>
        <option value="created">建立時間</option>
      </select>
    </div>

    <div id="notes-grid"></div>

    <div class="text-center mt-4">
      <a href="/dashboard" class="btn btn-secondary">返回儀表板</a>
    </div>
  </div>

  <!-- 編輯器 Modal -->
  <div id="editor-modal" class="modal">
    <div class="modal-content">
      <input type="text" id="note-title" placeholder="筆記標題" />
      <div class="editor-tabs">
        <button class="tab active" data-tab="write">編輯</button>
        <button class="tab" data-tab="preview">預覽</button>
      </div>
      <textarea id="note-content"></textarea>
      <div id="preview" class="markdown"></div>
      <div class="tags-input">
        <input type="text" id="tag-input" placeholder="[選填]輸入標籤，按 Enter" />
        <div id="tag-list"></div>
      </div>
      <div class="actions">
        <button id="save-note">儲存</button>
        <button id="cancel-edit">取消</button>
        <button id="share-note" style="display:none">分享</button>
      </div>
    </div>
  </div>

  <!-- 查看完整筆記 Modal -->
  <div id="view-modal" class="modal">
    <div class="modal-content view-modal-content">
      <div class="modal-header">
        <h2 id="view-title">載入中...</h2>
        <button id="close-view" class="close-btn">×</button>
      </div>
      <div class="modal-body">
        <div id="view-preview" class="markdown"></div>
        <div id="view-tags" class="note-tags mt-3"></div>
        <small id="view-timestamp" class="text-muted d-block mt-3"></small>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="/js/notebook.js"></script>
</body>
</html>